'use strict';

var app = angular.module('Meaniscule', ['ui.router']);

app.config(function ($urlRouterProvider, $locationProvider) {
   // This turns off hashbang urls (/#about) and changes it to something normal (/about)
   $locationProvider.html5Mode(true);
   // If we go to a URL that ui-router doesn't have registered, go to the "/" url.
   $urlRouterProvider.otherwise('/');
});
'use strict';

app.controller('HomeController', function ($scope) {
  //Initiating socket
  var socket = io();

  //Initiating the paper object to be globally available
  function initiate() {
    console.log('initiated!');
    paper.install(window);
    paper.setup('myCanvas');
  };
  initiate();

  //Putting stars on the night sky
  function stars() {
    var center = view.center;
    var points = 5;
    var radius1 = 5;
    var radius2 = 10;
    var star = new Path.Star(center, points, radius1, radius2);

    star.style = {
      fillColor: 'yellow'
    };

    var starArr = [];
    for (var i = 0; i < 100; i++) {
      var starCopy = star.clone();
      var randomPosition = Point.random();
      randomPosition.x = randomPosition.x * view.size._width;
      randomPosition.y = randomPosition.y * view.size._height;
      starCopy.position = randomPosition;
      starCopy.rotate(Math.random() * 20);
      starCopy.scale(0.25 + Math.random() * 0.75);
      starCopy.onMouseMove = function (event) {
        this.opacity = Math.random();
      };
      starArr.push(starCopy);
    }

    star.remove();

    view.onFrame = function (event) {
      for (var i = 0; i < starArr.length; i++) {
        starArr[i].fillColor.hue += (1 - Math.round(Math.random()) * 2) * (Math.random() * 5);
        starArr[i].rotate(Math.random());
        starArr[i].position.x += starArr[i].bounds.width / 200;
        if (starArr[i].bounds.left > view.size.width) {
          starArr[i].position.x = -starArr[i].bounds.width;
        }
      }
    };

    socket.emit('sendtheNight', project.activeLayer);
  };

  stars();
  $scope.stars = stars;

  // Drawing on the night sky
  var tool = new Tool();

  var stroke;
  var path_to_send = {};

  tool.onMouseDown = function (event) {
    stroke = new Path();
    stroke.fillColor = {
      hue: Math.random() * 360,
      saturation: 1,
      brightness: 1
    };
    stroke.add(event.point);

    //defining what to send via sockets
    path_to_send = {
      color: stroke.fillColor,
      start: event.point,
      stroke: []
    };
  };

  tool.onMouseDrag = function (event) {
    var step = event.delta.divide(2);
    step.angle += 90;

    var top = event.middlePoint.add(step);
    var bottom = event.middlePoint.subtract(step);

    stroke.add(top);
    stroke.insert(0, bottom);
    stroke.smooth();

    path_to_send.stroke.push({
      top: top,
      bottom: bottom
    });
    //sending my drawing
    socket.emit('meDrawing', JSON.stringify(path_to_send));
  };

  tool.onMouseUp = function (event) {
    stroke.add(event.point);
    stroke.closed = true;
    stroke.smooth();
  };

  // creating new tool to "erase" or "clear" the sky
  var tool2 = new Tool();

  var stroke3;
  var path_to_send2 = {};

  tool2.onMouseDown = function (event) {
    stroke3 = new Path();
    stroke3.fillColor = 'green'; //the color does not affect the functionality
    stroke3.opacity = 1;
    stroke3.strokeWidth = 20;
    stroke3.blendMode = 'destination-out'; //conflicts with stroke2.fillColor
    stroke3.add(event.point);
    // defining what to send via sockets
    path_to_send2 = {
      color: stroke3.fillColor,
      start: event.point,
      stroke3: [],
      blendMode: stroke3.blendMode
    };
  };

  tool2.onMouseDrag = function (event) {
    var step = event.delta.divide(2);
    step.angle += 90;

    var top = event.middlePoint.add(step);
    var bottom = event.middlePoint.subtract(step);

    stroke3.add(top);
    stroke3.insert(0, bottom);
    stroke3.smooth();

    path_to_send2.stroke3.push({
      top: top,
      bottom: bottom
    });

    //sending my clearing
    socket.emit('clearingTheSky', JSON.stringify(path_to_send2));
  };

  tool2.onMouseUp = function (event) {
    stroke3.add(event.point);
    stroke3.closed = true;
    stroke3.smooth();
  };

  var drawingTools = [tool, tool2];

  //buttons allow toggling between erasing and decorating the sky
  $scope.erase = function () {
    drawingTools[1].activate();
  };

  $scope.decorate = function () {
    drawingTools[0].activate();
  };

  //socket events

  // When friends start drawing
  socket.on('friendsDrawing', function (data) {
    var stroke2 = new Path();
    var friendsDrawing = JSON.parse(data);
    var eachStroke = friendsDrawing.stroke;
    var start_point = new Point(friendsDrawing.start[1], friendsDrawing.start[2]);
    var color = friendsDrawing.color;
    stroke2.fillColor = color;
    stroke2.add(start_point);
    for (var i = 0; i < eachStroke.length; i++) {
      stroke2.add(new Point(eachStroke[i].top[1], eachStroke[i].top[2]));
      stroke2.insert(0, new Point(eachStroke[i].bottom[1], eachStroke[i].bottom[2]));
    }
    stroke2.smooth();
    view.draw();
    view.update();
  });

  //when friends start to clear the sky
  socket.on('friendsClearing', function (data) {
    var stroke4 = new Path();
    var friendsClearing = JSON.parse(data);
    var clearingStroke = friendsClearing.stroke3;
    var start_clear_point = new Point(friendsClearing.start[1], friendsClearing.start[2]);
    var blendMode = friendsClearing.blendMode;
    var color = friendsClearing.color;
    stroke4.blendMode = blendMode;
    stroke4.fillColor = color;
    stroke4.add(start_clear_point);
    for (var i = 0; i < clearingStroke.length; i++) {
      stroke4.add(new Point(clearingStroke[i].top[1], clearingStroke[i].top[2]));
      stroke4.insert(0, new Point(clearingStroke[i].bottom[1], clearingStroke[i].bottom[2]));
    }
    stroke4.smooth();
    view.draw();
    view.update();
  });

  //when friends are also on the page, add 100 more stars to your view every minute
  socket.on('friendsSending', function () {
    window.setInterval(stars, 60000);
    view.update();
  });
});
//sending the night starry night
// socket.emit('sendtheNight', project);
'use strict';

app.config(function ($stateProvider) {
    $stateProvider.state('home', {
        url: '/',
        templateUrl: '/app/home/home.html',
        controller: 'HomeController'
    });
});
"use strict";

app.directive("navbar", function () {
	return {
		restrict: "E",
		templateUrl: "/app/navbar/navbar.html"
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwiaG9tZS9ob21lLnN0YXRlLmpzIiwibmF2YmFyL25hdmJhci5kaXJlY3RpdmUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7O0FBRXRELEdBQUcsQ0FBQyxNQUFNLENBQUMsVUFBVSxrQkFBa0IsRUFBRSxpQkFBaUIsRUFBRTs7QUFFekQsb0JBQWlCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDOztBQUVsQyxxQkFBa0IsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7Q0FDcEMsQ0FBQyxDQUFDOzs7QUNQSCxHQUFHLENBQUMsVUFBVSxDQUFDLGdCQUFnQixFQUFFLFVBQVMsTUFBTSxFQUFFOztBQUVoRCxNQUFJLE1BQU0sR0FBRyxFQUFFLEVBQUUsQ0FBQzs7O0FBR2xCLFdBQVMsUUFBUSxHQUFJO0FBQ25CLFdBQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDMUIsU0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN0QixTQUFLLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0dBQ3pCLENBQUM7QUFDRixVQUFRLEVBQUUsQ0FBQzs7O0FBR1gsV0FBUyxLQUFLLEdBQUk7QUFDaEIsUUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztBQUN6QixRQUFJLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDZixRQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7QUFDaEIsUUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQ2pCLFFBQUksSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQzs7QUFFM0QsUUFBSSxDQUFD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LEtBQUssQ0FBQyxDQUFDO0FBQ2pDLFFBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztHQUNmLENBQUMsQ0FBQTtDQUtILENBQUMsQ0FBQzs7Ozs7QUN4TkgsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLGNBQWMsRUFBRTtBQUNqQyxrQkFBYyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUU7QUFDekIsV0FBRyxFQUFFLEdBQUc7QUFDUixtQkFBVyxFQUFFLHFCQUFxQjtBQUNsQyxrQkFBVSxFQUFFLGdCQUFnQjtLQUMvQixDQUFDLENBQUM7Q0FDTixDQUFDLENBQUM7OztBQ05ILEdBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLFlBQVU7QUFDakMsUUFBTztBQUNOLFVBQVEsRUFBRSxHQUFHO0FBQ2IsYUFBVyxFQUFFLHlCQUF5QjtFQUN0QyxDQUFDO0NBQ0YsQ0FBQyxDQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ01lYW5pc2N1bGUnLCBbJ3VpLnJvdXRlciddKTtcblxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgLy8gVGhpcyB0dXJucyBvZmYgaGFzaGJhbmcgdXJscyAoLyNhYm91dCkgYW5kIGNoYW5nZXMgaXQgdG8gc29tZXRoaW5nIG5vcm1hbCAoL2Fib3V0KVxuICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAgLy8gSWYgd2UgZ28gdG8gYSBVUkwgdGhhdCB1aS1yb3V0ZXIgZG9lc24ndCBoYXZlIHJlZ2lzdGVyZWQsIGdvIHRvIHRoZSBcIi9cIiB1cmwuXG4gICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG59KTsiLCJhcHAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcbiAgLy9Jbml0aWF0aW5nIHNvY2tldFxuICB2YXIgc29ja2V0ID0gaW8oKTtcblxuICAvL0luaXRpYXRpbmcgdGhlIHBhcGVyIG9iamVjdCB0byBiZSBnbG9iYWxseSBhdmFpbGFibGVcbiAgZnVuY3Rpb24gaW5pdGlhdGUgKCkgeyBcbiAgICBjb25zb2xlLmxvZygnaW5pdGlhdGVkIScpO1xuICAgIHBhcGVyLmluc3RhbGwod2luZG93KTtcbiAgICBwYXBlci5zZXR1cChcIm15Q2FudmFzXCIpO1xuICB9O1xuICBpbml0aWF0ZSgpO1xuXG4gIC8vUHV0dGluZyBzdGFycyBvbiB0aGUgbmlnaHQgc2t5XG4gIGZ1bmN0aW9uIHN0YXJzICgpIHtcbiAgICB2YXIgY2VudGVyID0gdmlldy5jZW50ZXI7XG4gICAgdmFyIHBvaW50cyA9IDU7XG4gICAgdmFyIHJhZGl1czEgPSA1O1xuICAgIHZhciByYWRpdXMyID0gMTA7XG4gICAgdmFyIHN0YXIgPSBuZXcgUGF0aC5TdGFyKGNlbnRlciwgcG9pbnRzLCByYWRpdXMxLCByYWRpdXMyKTtcbiAgICBcbiAgICBzdGFyLnN0eWxlID0ge1xuICAgICAgZmlsbENvbG9yOiAneWVsbG93J1xuICAgIH1cblxuICAgIHZhciBzdGFyQXJyID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDA7IGkrKykge1xuICAgICAgdmFyIHN0YXJDb3B5ID0gc3Rhci5jbG9uZSgpO1xuICAgICAgdmFyIHJhbmRvbVBvc2l0aW9uID0gUG9pbnQucmFuZG9tKCk7XG4gICAgICByYW5kb21Qb3NpdGlvbi54ID0gcmFuZG9tUG9zaXRpb24ueCAqIHZpZXcuc2l6ZS5fd2lkdGg7XG4gICAgICByYW5kb21Qb3NpdGlvbi55ID0gcmFuZG9tUG9zaXRpb24ueSAqIHZpZXcuc2l6ZS5faGVpZ2h0O1xuICAgICAgc3RhckNvcHkucG9zaXRpb24gPSByYW5kb21Qb3NpdGlvbjtcbiAgICAgIHN0YXJDb3B5LnJvdGF0ZShNYXRoLnJhbmRvbSgpICogMjApO1xuICAgICAgc3RhckNvcHkuc2NhbGUoMC4yNSArIE1hdGgucmFuZG9tKCkgKiAwLjc1KTtcbiAgICAgIHN0YXJDb3B5Lm9uTW91c2VNb3ZlID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgdGhpcy5vcGFjaXR5ID0gTWF0aC5yYW5kb20oKTtcbiAgICAgIH1cbiAgICAgIHN0YXJBcnIucHVzaChzdGFyQ29weSk7XG4gICAgfVxuXG4gICAgc3Rhci5yZW1vdmUoKTtcblxuICAgIHZpZXcub25GcmFtZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHN0YXJBcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3RhckFycltpXS5maWxsQ29sb3IuaHVlICs9ICAoMSAtIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkgKiAyKSAqIChNYXRoLnJhbmRvbSgpICogNSk7XG4gICAgICAgIHN0YXJBcnJbaV0ucm90YXRlKE1hdGgucmFuZG9tKCkpO1xuICAgICAgICBzdGFyQXJyW2ldLnBvc2l0aW9uLnggKz0gc3RhckFycltpXS5ib3VuZHMud2lkdGggLyAyMDA7XG4gICAgICAgIGlmIChzdGFyQXJyW2ldLmJvdW5kcy5sZWZ0ID4gdmlldy5zaXplLndpZHRoKSB7XG4gICAgICAgICAgc3RhckFycltpXS5wb3NpdGlvbi54ID0gLXN0YXJBcnJbaV0uYm91bmRzLndpZHRoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgc29ja2V0LmVtaXQoJ3NlbmR0aGVOaWdodCcsIHByb2plY3QuYWN0aXZlTGF5ZXIpO1xuICB9O1xuICBcbiAgc3RhcnMoKTtcbiAgJHNjb3BlLnN0YXJzID0gc3RhcnNcblxuICAvLyBEcmF3aW5nIG9uIHRoZSBuaWdodCBza3lcbiAgdmFyIHRvb2wgPSBuZXcgVG9vbCgpO1xuXG4gIHZhciBzdHJva2U7XG4gIHZhciBwYXRoX3RvX3NlbmQgPSB7fTtcblxuICB0b29sLm9uTW91c2VEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgc3Ryb2tlID0gbmV3IFBhdGgoKTtcbiAgICBzdHJva2UuZmlsbENvbG9yID0ge1xuICAgICAgaHVlOiBNYXRoLnJhbmRvbSgpICogMzYwLFxuICAgICAgc2F0dXJhdGlvbjogMSxcbiAgICAgIGJyaWdodG5lc3M6IDFcbiAgICB9O1xuICAgIHN0cm9rZS5hZGQoZXZlbnQucG9pbnQpO1xuXG4gIC8vZGVmaW5pbmcgd2hhdCB0byBzZW5kIHZpYSBzb2NrZXRzXG4gICAgcGF0aF90b19zZW5kID0ge1xuICAgICAgY29sb3I6IHN0cm9rZS5maWxsQ29sb3IsXG4gICAgICBzdGFydDogZXZlbnQucG9pbnQsXG4gICAgICBzdHJva2U6IFtdXG4gICAgfTtcbiAgfTtcblxuICB0b29sLm9uTW91c2VEcmFnID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgdmFyIHN0ZXAgPSBldmVudC5kZWx0YS5kaXZpZGUoMilcbiAgICBzdGVwLmFuZ2xlICs9IDkwO1xuXG4gICAgdmFyIHRvcCA9IGV2ZW50Lm1pZGRsZVBvaW50LmFkZChzdGVwKTtcbiAgICB2YXIgYm90dG9tID0gZXZlbnQubWlkZGxlUG9pbnQuc3VidHJhY3Qoc3RlcCk7XG5cbiAgICBzdHJva2UuYWRkKHRvcCk7XG4gICAgc3Ryb2tlLmluc2VydCgwLCBib3R0b20pO1xuICAgIHN0cm9rZS5zbW9vdGgoKTtcblxuICAgIHBhdGhfdG9fc2VuZC5zdHJva2UucHVzaCh7XG4gICAgICB0b3A6IHRvcCxcbiAgICAgIGJvdHRvbTogYm90dG9tXG4gICAgfSk7XG4gICAgLy9zZW5kaW5nIG15IGRyYXdpbmdcbiAgICBzb2NrZXQuZW1pdCgnbWVEcmF3aW5nJywgSlNPTi5zdHJpbmdpZnkocGF0aF90b19zZW5kKSk7XG4gIH1cblxuICB0b29sLm9uTW91c2VVcCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgIHN0cm9rZS5hZGQoZXZlbnQucG9pbnQpO1xuICAgIHN0cm9rZS5jbG9zZWQgPSB0cnVlO1xuICAgIHN0cm9rZS5zbW9vdGgoKTtcbiAgfVxuXG4gIC8vIGNyZWF0aW5nIG5ldyB0b29sIHRvIFwiZXJhc2VcIiBvciBcImNsZWFyXCIgdGhlIHNreVxuICB2YXIgdG9vbDIgPSBuZXcgVG9vbCgpO1xuXG4gIHZhciBzdHJva2UzO1xuICB2YXIgcGF0aF90b19zZW5kMiA9IHt9O1xuXG4gIHRvb2wyLm9uTW91c2VEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgc3Ryb2tlMyA9IG5ldyBQYXRoKCk7XG4gICAgc3Ryb2tlMy5maWxsQ29sb3IgPSAnZ3JlZW4nOyAvL3RoZSBjb2xvciBkb2VzIG5vdCBhZmZlY3QgdGhlIGZ1bmN0aW9uYWxpdHlcbiAgICBzdHJva2UzLm9wYWNpdHkgPSAxO1xuICAgIHN0cm9rZTMuc3Ryb2tlV2lkdGggPSAyMDtcbiAgICBzdHJva2UzLmJsZW5kTW9kZSA9ICdkZXN0aW5hdGlvbi1vdXQnOyAvL2NvbmZsaWN0cyB3aXRoIHN0cm9rZTIuZmlsbENvbG9yXG4gICAgc3Ryb2tlMy5hZGQoZXZlbnQucG9pbnQpO1xuICAvLyBkZWZpbmluZyB3aGF0IHRvIHNlbmQgdmlhIHNvY2tldHNcbiAgICBwYXRoX3RvX3NlbmQyID0ge1xuICAgICAgY29sb3I6IHN0cm9rZTMuZmlsbENvbG9yLFxuICAgICAgc3RhcnQ6IGV2ZW50LnBvaW50LFxuICAgICAgc3Ryb2tlMzogW10sXG4gICAgICBibGVuZE1vZGU6IHN0cm9rZTMuYmxlbmRNb2RlXG4gICAgfVxuICB9XG5cbiAgdG9vbDIub25Nb3VzZURyYWcgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgc3RlcCA9IGV2ZW50LmRlbHRhLmRpdmlkZSgyKVxuICAgIHN0ZXAuYW5nbGUgKz0gOTA7XG5cbiAgICB2YXIgdG9wID0gZXZlbnQubWlkZGxlUG9pbnQuYWRkKHN0ZXApO1xuICAgIHZhciBib3R0b20gPSBldmVudC5taWRkbGVQb2ludC5zdWJ0cmFjdChzdGVwKTtcblxuICAgIHN0cm9rZTMuYWRkKHRvcCk7XG4gICAgc3Ryb2tlMy5pbnNlcnQoMCwgYm90dG9tKTtcbiAgICBzdHJva2UzLnNtb290aCgpO1xuXG4gICAgcGF0aF90b19zZW5kMi5zdHJva2UzLnB1c2goe1xuICAgICAgdG9wOiB0b3AsXG4gICAgICBib3R0b206IGJvdHRvbVxuICAgIH0pO1xuXG4gICAgLy9zZW5kaW5nIG15IGNsZWFyaW5nXG4gICAgc29ja2V0LmVtaXQoJ2NsZWFyaW5nVGhlU2t5JywgSlNPTi5zdHJpbmdpZnkocGF0aF90b19zZW5kMikpO1xuICB9XG5cbiAgdG9vbDIub25Nb3VzZVVwID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgc3Ryb2tlMy5hZGQoZXZlbnQucG9pbnQpO1xuICAgIHN0cm9rZTMuY2xvc2VkID0gdHJ1ZTtcbiAgICBzdHJva2UzLnNtb290aCgpO1xuICB9XG5cbiAgdmFyIGRyYXdpbmdUb29scyA9IFt0b29sLCB0b29sMl07XG5cblxuLy9idXR0b25zIGFsbG93IHRvZ2dsaW5nIGJldHdlZW4gZXJhc2luZyBhbmQgZGVjb3JhdGluZyB0aGUgc2t5XG4gICRzY29wZS5lcmFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBkcmF3aW5nVG9vbHNbMV0uYWN0aXZhdGUoKTtcbiAgfVxuXG4gICRzY29wZS5kZWNvcmF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBkcmF3aW5nVG9vbHNbMF0uYWN0aXZhdGUoKTtcbiAgfVxuXG5cbi8vc29ja2V0IGV2ZW50c1xuXG4gIC8vIFdoZW4gZnJpZW5kcyBzdGFydCBkcmF3aW5nXG4gIHNvY2tldC5vbignZnJpZW5kc0RyYXdpbmcnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgdmFyIHN0cm9rZTIgPSBuZXcgUGF0aCgpO1xuICAgICAgdmFyIGZyaWVuZHNEcmF3aW5nID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgIHZhciBlYWNoU3Ryb2tlID0gZnJpZW5kc0RyYXdpbmcuc3Ryb2tlO1xuICAgICAgdmFyIHN0YXJ0X3BvaW50ID0gbmV3IFBvaW50KGZyaWVuZHNEcmF3aW5nLnN0YXJ0WzFdLCBmcmllbmRzRHJhd2luZy5zdGFydFsyXSlcbiAgICAgIHZhciBjb2xvciA9IGZyaWVuZHNEcmF3aW5nLmNvbG9yXG4gICAgICBzdHJva2UyLmZpbGxDb2xvciA9IGNvbG9yO1xuICAgICAgc3Ryb2tlMi5hZGQoc3RhcnRfcG9pbnQpO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGVhY2hTdHJva2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3Ryb2tlMi5hZGQobmV3IFBvaW50KGVhY2hTdHJva2VbaV0udG9wWzFdLCBlYWNoU3Ryb2tlW2ldLnRvcFsyXSkpO1xuICAgICAgICBzdHJva2UyLmluc2VydCgwLCBuZXcgUG9pbnQoZWFjaFN0cm9rZVtpXS5ib3R0b21bMV0sIGVhY2hTdHJva2VbaV0uYm90dG9tWzJdKSk7XG4gICAgICB9XG4gICAgICBzdHJva2UyLnNtb290aCgpO1xuICAgICAgdmlldy5kcmF3KCk7XG4gICAgICB2aWV3LnVwZGF0ZSgpO1xuICB9KTtcbiAgXG4gIC8vd2hlbiBmcmllbmRzIHN0YXJ0IHRvIGNsZWFyIHRoZSBza3lcbiAgc29ja2V0Lm9uKCdmcmllbmRzQ2xlYXJpbmcnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgIHZhciBzdHJva2U0ID0gbmV3IFBhdGgoKTtcbiAgICB2YXIgZnJpZW5kc0NsZWFyaW5nID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICB2YXIgY2xlYXJpbmdTdHJva2UgPSBmcmllbmRzQ2xlYXJpbmcuc3Ryb2tlMztcbiAgICB2YXIgc3RhcnRfY2xlYXJfcG9pbnQgPSBuZXcgUG9pbnQoZnJpZW5kc0NsZWFyaW5nLnN0YXJ0WzFdLCBmcmllbmRzQ2xlYXJpbmcuc3RhcnRbMl0pXG4gICAgdmFyIGJsZW5kTW9kZSA9IGZyaWVuZHNDbGVhcmluZy5ibGVuZE1vZGU7XG4gICAgdmFyIGNvbG9yID0gZnJpZW5kc0NsZWFyaW5nLmNvbG9yXG4gICAgc3Ryb2tlNC5ibGVuZE1vZGUgPSBibGVuZE1vZGU7XG4gICAgc3Ryb2tlNC5maWxsQ29sb3IgPSBjb2xvcjtcbiAgICBzdHJva2U0LmFkZChzdGFydF9jbGVhcl9wb2ludCk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGNsZWFyaW5nU3Ryb2tlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzdHJva2U0LmFkZChuZXcgUG9pbnQoY2xlYXJpbmdTdHJva2VbaV0udG9wWzFdLCBjbGVhcmluZ1N0cm9rZVtpXS50b3BbMl0pKTtcbiAgICAgIHN0cm9rZTQuaW5zZXJ0KDAsIG5ldyBQb2ludChjbGVhcmluZ1N0cm9rZVtpXS5ib3R0b21bMV0sIGNsZWFyaW5nU3Ryb2tlW2ldLmJvdHRvbVsyXSkpO1xuICAgIH1cbiAgICBzdHJva2U0LnNtb290aCgpO1xuICAgIHZpZXcuZHJhdygpO1xuICAgIHZpZXcudXBkYXRlKCk7ICBcbiAgfSk7XG5cbiAgLy93aGVuIGZyaWVuZHMgYXJlIGFsc28gb24gdGhlIHBhZ2UsIGFkZCAxMDAgbW9yZSBzdGFycyB0byB5b3VyIHZpZXcgZXZlcnkgbWludXRlXG4gIHNvY2tldC5vbignZnJpZW5kc1NlbmRpbmcnLCBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LnNldEludGVydmFsKHN0YXJzLCA2MDAwMCk7XG4gICAgdmlldy51cGRhdGUoKTtcbiAgfSlcblxuICAvL3NlbmRpbmcgdGhlIG5pZ2h0IHN0YXJyeSBuaWdodFxuICAvLyBzb2NrZXQuZW1pdCgnc2VuZHRoZU5pZ2h0JywgcHJvamVjdCk7XG5cbn0pO1xuIiwiYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcidcbiAgICB9KTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoXCJuYXZiYXJcIiwgZnVuY3Rpb24oKXtcblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogXCJFXCIsXG5cdFx0dGVtcGxhdGVVcmw6IFwiL2FwcC9uYXZiYXIvbmF2YmFyLmh0bWxcIlxuXHR9O1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9